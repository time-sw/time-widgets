<div id="yt-widget" style="font-family:Arial, sans-serif; background:#1c1c1c; color:#fff; padding:15px; border-radius:10px; width:450px;">
  <h2 style="color:#ffcc00; text-align:center;">tiempo_videojuegos</h2>
  <ul id="yt-videos" style="list-style:none; padding:0; margin:0; max-height:400px; overflow-y:auto;"></ul>
  <div style="text-align:center; margin-top:10px;">
    <button id="prevPage" style="margin-right:10px;">Previous</button>
    <button id="nextPage">Next</button>
  </div>
</div>

<script>
const apiKey = "AIzaSyDOkALkr1QQuP5t1tVXVbtyZWLjLE7mtCA";
const channelId = "UCLd7iswJ7rlNnOoHpIL1aMw";
let nextPageToken = "";
let prevPageTokens = [];

async function fetchUploadsPage(pageToken = "") {
  // Step 1: Get the uploads playlist ID
  let res = await fetch(`https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${channelId}&key=${apiKey}`);
  let data = await res.json();
  const uploadsPlaylistId = data.items[0].contentDetails.relatedPlaylists.uploads;

  // Step 2: Fetch videos from the playlist
  let url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${uploadsPlaylistId}&maxResults=10&key=${apiKey}`;
  if(pageToken) url += `&pageToken=${pageToken}`;

  let playlistRes = await fetch(url);
  let playlistData = await playlistRes.json();

  nextPageToken = playlistData.nextPageToken || "";
  displayVideos(playlistData.items);
}

function displayVideos(videos) {
  const videoList = document.getElementById("yt-videos");
  videoList.innerHTML = "";

  videos.forEach(item => {
    const li = document.createElement("li");
    li.style.display = "flex";
    li.style.alignItems = "center";
    li.style.gap = "10px";
    li.style.marginBottom = "8px";
    li.style.color = "#fff"; // White letters

    const img = document.createElement("img");
    img.src = item.snippet.thumbnails.default.url;
    img.alt = item.snippet.title;
    img.style.width = "80px";
    img.style.height = "45px";
    img.style.borderRadius = "4px";

    const a = document.createElement("a");
    a.href = `https://www.youtube.com/watch?v=${item.snippet.resourceId.videoId}`;
    a.target = "_blank";
    a.textContent = item.snippet.title;
    a.style.color = "#fff"; // White letters
    a.style.textDecoration = "none";
    a.style.flexGrow = "1";

    li.appendChild(img);
    li.appendChild(a);
    videoList.appendChild(li);
  });
}

// Initial load
fetchUploadsPage();

// Pagination buttons
document.getElementById("nextPage").addEventListener("click", () => {
  if(nextPageToken) {
    prevPageTokens.push(nextPageToken);
    fetchUploadsPage(nextPageToken);
  }
});

document.getElementById("prevPage").addEventListener("click", () => {
  if(prevPageTokens.length > 0) {
    const prevToken = prevPageTokens.pop();
    fetchUploadsPage(prevToken);
  }
});
</script>
